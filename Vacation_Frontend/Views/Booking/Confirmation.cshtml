@model VacationBooking.Models.Booking
@{
    ViewData["Title"] = "Booking Confirmation";
    
    // Add null checks to prevent exceptions
    var bookingExists = Model != null;
    var vacationExists = bookingExists && Model.Vacation != null;
    var destinationExists = vacationExists && Model.Vacation.Destination != null;
    var accommodationExists = vacationExists && Model.Vacation.Accommodation != null;
}

@if (!bookingExists)
{
    <div class="alert alert-danger">
        <h4>Error</h4>
        <p>The booking information could not be found. Please contact customer support.</p>
        <a asp-controller="Home" asp-action="Index" class="btn btn-primary">Return Home</a>
    </div>
}
else
{
    <div class="card">
        <div class="card-header bg-success text-white">
            <h2 class="mb-0">Booking Confirmed!</h2>
        </div>
        <div class="card-body">
            <h4>Thank you for your booking</h4>
            <p>Your booking has been confirmed. Please find the details below.</p>
            
            <hr />
            
            <div class="row">
                <div class="col-md-6">
                    <h5>Booking Details</h5>
                    <dl class="row">
                        <dt class="col-sm-4">Booking ID</dt>
                        <dd class="col-sm-8">@Model.BookingID</dd>
                        
                        <dt class="col-sm-4">Booking Date</dt>
                        <dd class="col-sm-8">@Model.BookingDate.ToLongDateString()</dd>
                        
                        <dt class="col-sm-4">Check-in Date</dt>
                        <dd class="col-sm-8">@Model.CheckInDate.ToLongDateString()</dd>
                        
                        <dt class="col-sm-4">Number of Nights</dt>
                        <dd class="col-sm-8">@Model.NumberOfNights</dd>
                        
                        <dt class="col-sm-4">Number of Guests</dt>
                        <dd class="col-sm-8">@Model.NumberOfGuests</dd>
                        
                        <dt class="col-sm-4">Total Price</dt>
                        <dd class="col-sm-8">$@Model.TotalPrice</dd>
                    </dl>
                </div>
                
                @if (vacationExists)
                {
                    <div class="col-md-6">
                        <h5>Vacation Package</h5>
                        <dl class="row">
                            <dt class="col-sm-4">Vacation</dt>
                            <dd class="col-sm-8">@Model.Vacation.Name</dd>
                            
                            @if (destinationExists)
                            {
                                <dt class="col-sm-4">City</dt>
                                <dd class="col-sm-8">@Model.Vacation.Destination.City</dd>
                                
                                <dt class="col-sm-4">Country</dt>
                                <dd class="col-sm-8">@Model.Vacation.Destination.Country</dd>
                            }
                            
                            @if (accommodationExists)
                            {
                                <dt class="col-sm-4">Package Type</dt>
                                <dd class="col-sm-8">@Model.Vacation.Accommodation.RoomType</dd>
                            }
                        </dl>
                    </div>
                }
            </div>
            
            @if (!string.IsNullOrEmpty(Model.SpecialRequests))
            {
                <div class="mt-3">
                    <h5>Special Requests</h5>
                    <p>@Model.SpecialRequests</p>
                </div>
            }
        </div>
        <div class="card-footer">
            <a asp-controller="Account" asp-action="Profile" class="btn btn-primary">View Your Bookings</a>
            <a asp-controller="Home" asp-action="Index" class="btn btn-secondary">Return Home</a>
        </div>
    </div>
}
