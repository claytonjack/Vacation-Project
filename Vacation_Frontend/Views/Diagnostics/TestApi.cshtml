@model Dictionary<string, string>
@{
    ViewData["Title"] = "API Connection Test";
}

<h1>API Connection Diagnostics</h1>

<div class="alert alert-info">
    <p><strong>Instructions:</strong> This page helps diagnose API connection issues. If any tests succeed with status 200, 
    use that URL in your appsettings.json's ApiSettings:BaseUrl.</p>
</div>

<div class="card mb-4">
    <div class="card-header bg-primary text-white">API Connection Tests</div>
    <div class="card-body">
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Test</th>
                    <th>Result</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model)
                {
                    <tr>
                        <td><strong>@item.Key</strong></td>
                        <td>
                            @if (item.Value.StartsWith("ERROR"))
                            {
                                <span class="text-danger">@item.Value</span>
                            }
                            else if (item.Value.Contains("Status: 200"))
                            {
                                <span class="text-success">@item.Value</span>
                            }
                            else
                            {
                                <span>@item.Value</span>
                            }
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>

<div class="mt-4">
    <h2>Next Steps</h2>
    <ol>
        <li>Find a port test that returned status 200</li>
        <li>Update your appsettings.json with that URL</li>
        <li>Restart the application</li>
    </ol>

    <div class="alert alert-warning">
        <strong>Configuration Fix:</strong> Add the following to appsettings.json:
        <pre><code>
"ConnectionStrings": {
    "DefaultConnection": "Server=LAPTOP\\SQLEXPRESS;Database=VacationDB;Trusted_Connection=True;MultipleActiveResultSets=true;TrustServerCertificate=True"
},
"ApiSettings": {
    "BaseUrl": "http://localhost:5075/api"  # Replace 5075 with whatever port worked
}
        </code></pre>
    </div>
</div> 